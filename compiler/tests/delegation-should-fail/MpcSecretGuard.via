/* NoSelectionSolutionError */

process main {
  /* Chuck hides the ball under a shell; Alice guesses the shell. */
  val shell: int = endorse (input int from Chuck) to {Chuck & Alice<-} from {Chuck};
  val guess: int = endorse (input int from Alice) to {Alice & Chuck<-} from {Alice};

  var win_secret: bool{Alice & Chuck};
  var nice: bool{Alice & Chuck};

  /* Cannot compute conditional guard in MPC because of the loop in the else branch. */
  /* Chuck must prove that `shell` is valid without revealing its value. */
  if (1 <= shell && shell <= 3 && guess + shell <= 10) {
    win_secret = shell == guess;
  } else {
    win_secret = true;
    while (true) { nice = true; }
  }

  val win: bool{Alice ⊓ Chuck} = declassify win_secret to {Alice ⊓ Chuck};
  output win to Alice;
  output win to Chuck;
}

hosts: Alice, Chuck

